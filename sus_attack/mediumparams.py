from sage.all import Integer, polygen, ZZ

"""
Medium params for testing
lg N: 2048
lg p: 1646
lg q: 402

backdoor nvars: 4
f(e) = 0 mod phi(p), not mod phi(N)
entropy of f: roughly 20 bits
exploitations: can use mult=3, extras=[]. 70 dimensional lattice.
"""

e = 65537
p = 2133202872110939232315089831936562351837867417603688439787862273108008016404807787779217052397709858216147639826731291089487591507238580080005968191265646609920206395722140348446182218882966731148759688782328651254164732671007420576121229945089637654162020327209033090763449054065348369041228868039721448592865031100465338217972149580700406395130779594155098461489988433074719884470966991367686974166414726468670472853645580429297586753863948236502037669941671342088484173029527193160496851881089 # 1646 bits
q = 8620636494929521883078863463203141901734812106106035491162098983396898146201767839955833916894393543227489746968964833647 # 402 bits
N = p*q # 2048 bits
k = 2048-224 # unknown size: 224 bits

e,p,q,N,k = Integer(e),Integer(p),Integer(q),Integer(N),Integer(k)

x = polygen(ZZ)
f = x**150 - x**66 - x**57 + x**40
relation_coeffs = [(150,1),(66,-1),(57,-1),(40,1)]

hints = {'mult': 3}
