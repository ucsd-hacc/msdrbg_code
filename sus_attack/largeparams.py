from sage.all import Integer, polygen, ZZ

"""
Large parameters
lg N: 15360
lg p: 14459
lg q: ...

backdoor nvars: 6
f(e) == 0 mod phi(p), not mod phi(N)

Entropy of f: 51 bits

Use multiplicity 3
"""

e = Integer(41)
p = Integer("0x"
"74e296864a75a92b0bbe2be4e81c58a0e1c846cddfbe7b22d67fa97dc1ec19006aa74dd1eef5ddbf"
"5e47c1b5f20fa69f0e66f6b6e94e998ce5b3e250d22aa5b087a8ed6f74137178f40c690c97dd087f"
"44bda92223c79161582a9588bba4667a357a7273d4fe92e11a2157bb73d369442b6bc12c737ec931"
"1442e3619562d62e51f43f7c0298559fc347c1390e796c408c7f105ac32a21c8221d661d4334537c"
"8a4c298611da287389190fb1a8cc087df9d2ad7d6e3cd8fc7ff82afd5e5bb163ab6a075e069ab305"
"68b0664e5640c9c34d93e285d4849dd223232a54faf53c501725d6b141188c8d7480b45497fee122"
"ef7783f00d87cd04c37afd7be98b58cc58573110d931be42a5027d746201f871a9a4beadd3497d51"
"a291ee6df0cc94a233ba86fdcad7a94ad81f0b9f76d804fc15bb12bc93bdd587e312eb544bb290da"
"8beb77ab5d0e5d07b3f5a00f115200f13840c389d91685670e93e9c6754b4cec0c5b99a54b902b04"
"becb7a3b639b0c1a370588a98d38124092c7a79cd4aeaa6e06b782b602636249eab38fbbf360e9fb"
"f56b1294fac8f82d1e76d3173afc495c763e2ddb2b528740b4b9bff95166fe464a2baf7dc2486254"
"15e28c6c23c2603c1033547824172de2716111594518dff62125f8cbf8320b60daa1a01f7fa9c1d6"
"59bc0eeb3078514c160e6eefa426eaa720e47e14554206e28dfbfb86fded68671a34d0d4c1cac36a"
"f664eafc3e59b240902aaed87ae4cb2f5d7d1844c62fa4859d55c4a74c3664c812f50c78635529f1"
"c473275b4716d09ac5dbe01322d04ee5ae9c7a54729b9baa30f84a5af0a5fc0ff01e28ab0f2ee2e4"
"7081c551c2a7ede326bb6aaabb927e1b687a60511f4a3aa2a6890c111f06986020c91dc871bbbf3e"
"7991775cdc52d4459a8584b8c538db61baa78e85e51281113854ba972f9dc6c4736b6a93fac78e3d"
"6285063faaf559fb3bdce11e0529bdb4bb7aad46254a99d206d832ece82ac777ddec46dd4bea4320"
"f58d9e9d60c38edef733f03d6d4823944b2eab82ce5d5bed7be5ec4ff8f32e22db44e4163622605f"
"e898d1e5ff3faa64cd5958b0612cc281df7e2ba2473c1f115b8e135f93d861704fdfeb7eb2489e47"
"ed390b3c22468ba7656db0ff7fce1bd7a3c2469a0b5920eb6cc94f9e432ec579f058fb16c682ab18"
"720f9c237a59909bf6df7873a539139e5bdf489e59ee51f2ab0ec169d6dcceee32aee446a163b808"
"54b86a9a05e7440d8de40c05c0f8e225a672a1594e64974b6427814fcbd6fe83314a13f8aa4b28d8"
"84b1090d32917da93141731086f4cb0430e0e7960ad90463c85741e4dd1dd3744d494ec3824a4115"
"43b67ffbc04737042fd276a5712db5402cd386e9dab9303256f6c98c830f75adfabdb0c5b289ba85"
"bf27289749d9ba22eff7b3045f8712ad99bf0afb217948ed690eebea5aa089b53e502e151a7578ee"
"0777faa4c9281ab1e959f05366444123c0eda329a99b6edfbabd67ed52bdb25b821fb1914f2de1e8"
"cf26f04b21a8716dfefc99737426103a48dc30f73142ce35bbd262b2b163776e948f534113acf1d8"
"5a675e2df7a7c57d80823085587099f947ee53d316c10128315b78706fb717f9fbee12ea6ccaacbf"
"1fbc3109a98a024375f0195393003657aabea5dac138c37ad92fd41f7ee440802ada7285f16082e0"
"df0f3b9859faf9344b7129935725fa60e17c141023679ca9a19022e43d5d790db814df33112fd3cb"
"45d90e533826bc7321bc4f924bcde4e361e7b369cb7606674106f2a7a56c9d066e44bb7215e4a294"
"2159dad9c1635bfb1fb1ce072064ba3bb5cba0a3e11a3a7499836554055f09cff760b1fc394b3af8"
"eb25079801fc5be37ab159b3d990b02baaa8ee8a7f9596b9e2bc7e0eba4282323598817e246cd716"
"ef632bb77b5bbd40bf386808a03d939353b8a80e4766a617d61004e723eec6ecd856f79acac1b427"
"0a896fc1bf71d7018f06e594ad226a8293426050af2dfc4e4d9b9d7c1a1e25dba48ab39ad5f3b241"
"4e7e2e93c1c068b804da36fa5e0d669c8e7addb57670fdba352396ea60430026d93ea0ec5761209e"
"92192f5272f8ec17bfb6f14b9c2ff325bf15ae654f92d203f25b09834dea537bca75ee85c8cdea77"
"3593e4691948a09b0666df9609c1da38a891524d683ac6811dba5641d507dee4304d3ad99eeddb4c"
"6ef9b4e02e27893318d6dc4d2f7c10f9a9d61444054d877ce05056bb1d17f0734767032c0d754d8c"
"a6efb0b5f7410cb93980d677d58fea806df6d8a064d95c687ce99951e616c71762fdbbd93bbf2b8f"
"bd9aa67aeefe3a417f28478d534f7fee12dd0c0520ebaf92a45da4d54720c0792a1655f04ef71358"
"3447c3cabff548d008a6830612006e4d61c8300a452f9db7cac30396f37d91d1aa73671c070ca6ed"
"d33a0d904a6b3b35e0463145423ff32a2bfe95e9f5395bae978f7dc63d5f68bee3f4c1b6752031ca"
"cd9806409136e513e056b5b2fd8d645ef3e3829a3c090c2020aab8e794dbce014913e2453950cc33"
"dc50b3c4e0bc815")

q = Integer("0x"
"18d790ae5685a54e6ceb1224598eb74ed9b1d9b7946f48849752b43291222b53f4de9db89aa7635f"
"c63944eafb0582a9a9877962274bc64f6b188754f06c7c12f62c938c1d33178e8758f1112cfbbdae"
"d35f84a8fea7f925640e9c0e62bf9c6d3ba8f2ae6daa343bba6755df420e932a57")

N = p*q
k = 15360-752

e,p,q,N,k = Integer(e),Integer(p),Integer(q),Integer(N),Integer(k)

x = polygen(ZZ)
f = x**3500 + x**3160 - x**2580 + x**2443 - x**2043 - x**1070
relation_coeffs = [(3500,1),(3160,1),(2580,-1),(2443,1),(2043,-1),(1070,-1)]

assert f(e) % (p-1) == 0

hints = {
	'grob_mod': Integer(
93172129138980370341245860323284571540070332913915119384149789635954295295070925888271395414373618162427239023837684386718632916320454808137801905734471817082181587294143307593617623663788252699595615396638178633676282372715649
),
	'mult': 3,
}
